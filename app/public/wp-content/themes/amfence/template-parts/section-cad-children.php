<section id="cad-grid">

<?php

$vars = get_query_var('args');
//var_dump($vars);
$related_products = array();
$args = array(
    'post_type'      => 'cad_drawing',
    'posts_per_page' => $vars['num_items'],
	'orderby'		 => 'menu_order',
	'order'			 => 'ASC',
	'post_parent'	 => $vars['parent_id']
 );

$cad = new WP_Query( $args );

if ( $cad->have_posts() ) : ?>
	<div class="container">
		<div class="row">
			<div class="col"><h2><?php echo $vars['title']; ?></h2></div>
		</div>
		<div class="row">
			<?php 
			while ( $cad->have_posts() ) : $cad->the_post(); 
				$args_parent = array('post_parent' => get_the_ID(), 'post_type' => 'cad_drawing');
				//var_dump($args_parent);
				$children = get_children($args_parent);
				//var_dump($children);
				if(!empty($children)){
					
			?>
				<div id="cad-<?php the_ID(); ?>" class="col-lg-3 col-md-4 col-sm-6 col-xs-12 cad-grid">
					<a href="<?php the_permalink(); ?>">
					<div class="item" style="background-image:url(<?php echo get_the_post_thumbnail_url($cad->ID, 'medium'); ?>)">
						
					</div>
					<h3><?php the_title(); ?></h3>
					</a>
					
					<p><?php the_excerpt(); ?></p>
					<a class="learn-more-btn" href="<?php the_permalink(); ?>">View Files</a>
				</div>
				
			<?php 
				} // end children grid item
				else{
			?>
					
				
				<div id="cad-<?php the_ID(); ?>" class="col-lg-3 col-md-4 col-sm-6 col-xs-12 cad-grid cad-child">
					
					<div class="item" style="background-image:url(<?php echo get_the_post_thumbnail_url($cad->ID, 'full'); ?>)">
						
					</div>
					<h3><?php the_title(); ?></h3>
					<?php
						//if(get_field('cad_file_dwg') || get_field('pdf_drawing'))
							//echo "<p>Download</p>";
						
					
						if(get_field('cad_file_dwg')){
					?>
							<a href="<?php echo get_field('cad_file_dwg'); ?>"><svg xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" width="55" height="55" viewBox="0 0 14.552081 14.552081" version="1.1" id="svg4585">
  <g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(0,-282.44795)">
    <path
       style="fill:#5a5a5a;fill-opacity:1;stroke:#5a5a5a;stroke-width:0.4;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:.45"
       d="m 7.0039195,296.58724 c -0.5488034,-0.0316 -0.9353683,-0.0863 -1.393936,-0.19725 -1.4313074,-0.34617 -2.7261117,-1.13322 -3.6747918,-2.23373 -0.8116055,-0.9415 -1.34117615,-2.04898 -1.55911391,-3.26055 -0.0370311,-0.20585 -0.0690245,-0.45882 -0.0899939,-0.71152 -0.0131286,-0.15819 -0.0132177,-0.78638 -1.3746e-4,-0.94625 0.0558934,-0.68319 0.18252567,-1.26483 0.40883505,-1.87784 0.39037622,-1.05743 1.05345402,-2.01756 1.91457182,-2.77229 1.1097261,-0.97262 2.4808974,-1.56688 3.969049,-1.72017 0.2749321,-0.0283 0.3777568,-0.033 0.7226457,-0.0331 0.3460815,-8e-5 0.4429922,0.004 0.7263137,0.0334 1.4962973,0.15338 2.8850183,0.76123 4.0020643,1.75173 0.117876,0.10452 0.357136,0.33906 0.475951,0.46657 0.999644,1.07273 1.63459,2.46223 1.78653,3.90961 0.02985,0.28439 0.03384,0.36889 0.03377,0.71519 -7e-5,0.3464 -0.0045,0.4402 -0.03366,0.71519 -0.09304,0.87698 -0.36111,1.73784 -0.78198,2.51121 -0.815573,1.49865 -2.14707,2.63783 -3.7732788,3.22829 -0.6117676,0.22214 -1.2133824,0.35037 -1.9148276,0.40816 -0.1261601,0.0104 -0.7053208,0.0198 -0.8180202,0.0133 z m 0.7859529,-0.0725 c 1.1648679,-0.0863 2.2409336,-0.43031 3.2197786,-1.02925 0.80266,-0.49114 1.518576,-1.16761 2.056098,-1.94279 0.699733,-1.00912 1.098431,-2.14665 1.191282,-3.39889 0.01258,-0.16971 0.01263,-0.69761 8.2e-5,-0.86556 -0.06301,-0.84305 -0.253506,-1.598 -0.590929,-2.34195 -0.72771,-1.60445 -2.077195,-2.88193 -3.7423358,-3.54267 -0.6921814,-0.27466 -1.3917181,-0.43283 -2.1532639,-0.48687 -0.2110999,-0.0149 -0.691169,-0.017 -0.8877173,-0.004 -0.9888034,0.0664 -1.8722493,0.30091 -2.7255116,0.7235 -1.9577294,0.96959 -3.32703481,2.76854 -3.71577361,4.88165 -0.0407666,0.22161 -0.0724425,0.46772 -0.0929919,0.72253 -0.0172841,0.21431 -0.0172778,0.74451 1.4e-5,0.96093 0.0271862,0.34027 0.071101,0.64197 0.13769768,0.94597 0.37632363,1.71777 1.41027703,3.22276 2.89369773,4.21197 0.3970474,0.26477 0.8471652,0.50017 1.3086163,0.68437 0.7333216,0.29274 1.5482681,0.46286 2.3703274,0.4948 0.1336585,0.005 0.5907033,-0.004 0.7309294,-0.0139 z m -4.191549,-1.62001 c -0.00522,-0.008 -0.0072,-0.16261 -0.00846,-0.66125 l -0.00108,-0.43256 -0.3853793,-0.38577 -0.3853793,-0.38578 0.0049,-0.12059 c 0.00267,-0.0663 7.637e-4,-0.73738 -0.00426,-1.49123 -0.00845,-1.26919 -0.00823,-1.37154 0.00293,-1.38271 0.010806,-0.0108 0.049848,-0.0123 0.3759705,-0.0142 l 0.3639122,-0.002 -0.00477,-1.06153 c -0.00261,-0.58384 -0.00636,-1.149 -0.0083,-1.25591 -0.00197,-0.10691 -0.00566,-0.59544 -0.00817,-1.08563 -0.00255,-0.49018 -0.00689,-1.21307 -0.00967,-1.60643 -0.00395,-0.56017 -0.00312,-0.71851 0.00401,-0.73053 0.00809,-0.0138 0.018251,-0.0158 0.098803,-0.0202 0.049377,-0.003 1.3602351,-0.005 2.9130145,-0.005 h 2.8232318 l 0.01204,0.0184 c 0.00662,0.0101 0.2039596,0.20402 0.4385261,0.43092 0.2345651,0.2269 0.5354541,0.51819 0.6686411,0.6473 0.133187,0.12912 0.392349,0.37982 0.575916,0.55711 0.183567,0.1773 0.384104,0.37132 0.445639,0.43116 l 0.111882,0.10881 v 0.0933 c 0,0.0514 0.0033,0.56535 0.0072,1.14227 0.0039,0.57692 0.01209,1.86262 0.01804,2.8571 0.0059,0.99449 0.01258,2.00786 0.01473,2.25194 0.0022,0.24408 0.006,0.81615 0.0087,1.27125 0.0046,0.80796 0.0045,0.82755 -0.0091,0.83093 -0.02491,0.006 -8.0596616,0.007 -8.0634945,6.4e-4 z m 8.0066816,-0.8577 c -0.0052,-0.83909 -0.01118,-1.7955 -0.03377,-5.3617 -0.0075,-1.18488 -0.01604,-2.15821 -0.01897,-2.16295 -0.004,-0.006 -0.05556,-0.008 -0.204277,-0.004 -0.109421,0.003 -0.570357,0.006 -1.024304,0.008 -0.4539446,0.002 -0.8619517,0.006 -0.9066804,0.008 l -0.081324,0.004 -0.0049,-0.49699 c -0.00267,-0.27335 -0.0049,-0.63426 -0.0049,-0.80204 -5.1e-6,-0.16776 -0.00216,-0.44124 -0.00484,-0.60771 l -0.00484,-0.30267 -2.8603425,3.4e-4 c -2.5983823,1.7e-4 -2.860749,0.001 -2.8647843,0.0118 -0.00242,0.006 -6.364e-4,0.62273 0.00401,1.36969 0.00465,0.74696 0.010106,1.66344 0.012129,2.03663 0.00204,0.37318 0.00528,0.80229 0.0073,0.95359 0.00197,0.15128 0.00414,0.49623 0.00471,0.76653 6.059e-4,0.27031 0.00261,0.50715 0.00439,0.52631 l 0.00331,0.0349 h 3.5678187 3.5678165 l 0.019,0.0226 0.019,0.0226 3.37e-4,0.46706 c 1.69e-4,0.25689 0.0017,0.48687 0.0032,0.51107 0.0024,0.0378 0.01517,1.82946 0.01372,1.92775 -3.37e-4,0.0194 -0.0037,0.0384 -0.0076,0.0424 -0.0046,0.004 -1.2836276,0.007 -3.5897606,0.007 l -3.5826432,-3.3e-4 0.00484,0.32834 c 0.00267,0.18058 0.00554,0.53464 0.00638,0.7868 8.273e-4,0.25215 0.00267,0.51374 0.00414,0.58132 l 0.00261,0.12286 h 3.9770693 3.9770695 l -0.005,-0.80138 z M 3.5862888,293.5639 c -0.00261,-0.0757 -0.00484,-0.22913 -0.00484,-0.34109 l -2.04e-5,-0.20356 H 3.2384795 2.8955278 l 0.3410878,0.3411 c 0.1875989,0.18759 0.3440998,0.34109 0.3477806,0.34109 0.00395,0 0.00471,-0.0561 0.00191,-0.13754 z m 7.1637262,-1.36987 c -0.0015,-0.41958 -0.0048,-1.06655 -0.0073,-1.43772 l -0.0045,-0.67485 -3.935326,-0.002 -3.9353258,-0.002 0.00477,0.5593 c 0.00261,0.30761 0.00653,0.92899 0.00867,1.38085 0.00216,0.45186 0.00573,0.84874 0.00801,0.88197 l 0.00414,0.0604 3.9298816,-0.002 3.9298822,-0.002 z m 0.5222,-5.74455 c 0.140377,-0.003 0.254274,-0.007 0.253109,-0.0106 -0.0021,-0.006 -0.09548,-0.0965 -0.981716,-0.95339 -0.235957,-0.22815 -0.5907802,-0.57134 -0.7884989,-0.76265 l -0.3594894,-0.34784 -0.00235,0.18315 c -0.00134,0.10075 -7.07e-5,0.57064 0.00274,1.04423 l 0.00509,0.86107 0.8079453,-0.004 c 0.44437,-0.003 0.922798,-0.007 1.063173,-0.009 z"
       id="path4546"
       inkscape:connector-curvature="0" />
    <text xml:space="preserve" style="font-style:normal;font-weight:normal;font-size:2.40819693px;line-height:2.25;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;fill:#cf1f2f;fill-opacity:1;stroke:none;stroke-width:0.26458332" x="3.9452205" y="292.29498" id="text4566" transform="scale(1.0000816,0.99991843)"><tspan
         sodipodi:role="line"
         id="tspan4564"
         x="3.9452205"
         y="292.52498"
         style="stroke-width:0.26458332">DWG</tspan></text>
  </g>
</svg><!--<img class="download-icon" src="/wp-content/themes/amfence/images/dwg-turq.png" alt="Download .dwg file" />--></a>
					<?php
						}
						if(get_field('pdf_drawing')){
					?>
							<a href="<?php echo get_field('pdf_drawing'); ?>"><svg xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" width="55" height="55" viewBox="0 0 14.552081 14.552081" version="1.1" id="svg4585">
  <g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(0,-282.44795)">
    <path
       style="fill:#5a5a5a;fill-opacity:1;stroke:#5a5a5a;stroke-width:0.4;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:.45"
       d="m 7.0039195,296.58724 c -0.5488034,-0.0316 -0.9353683,-0.0863 -1.393936,-0.19725 -1.4313074,-0.34617 -2.7261117,-1.13322 -3.6747918,-2.23373 -0.8116055,-0.9415 -1.34117615,-2.04898 -1.55911391,-3.26055 -0.0370311,-0.20585 -0.0690245,-0.45882 -0.0899939,-0.71152 -0.0131286,-0.15819 -0.0132177,-0.78638 -1.3746e-4,-0.94625 0.0558934,-0.68319 0.18252567,-1.26483 0.40883505,-1.87784 0.39037622,-1.05743 1.05345402,-2.01756 1.91457182,-2.77229 1.1097261,-0.97262 2.4808974,-1.56688 3.969049,-1.72017 0.2749321,-0.0283 0.3777568,-0.033 0.7226457,-0.0331 0.3460815,-8e-5 0.4429922,0.004 0.7263137,0.0334 1.4962973,0.15338 2.8850183,0.76123 4.0020643,1.75173 0.117876,0.10452 0.357136,0.33906 0.475951,0.46657 0.999644,1.07273 1.63459,2.46223 1.78653,3.90961 0.02985,0.28439 0.03384,0.36889 0.03377,0.71519 -7e-5,0.3464 -0.0045,0.4402 -0.03366,0.71519 -0.09304,0.87698 -0.36111,1.73784 -0.78198,2.51121 -0.815573,1.49865 -2.14707,2.63783 -3.7732788,3.22829 -0.6117676,0.22214 -1.2133824,0.35037 -1.9148276,0.40816 -0.1261601,0.0104 -0.7053208,0.0198 -0.8180202,0.0133 z m 0.7859529,-0.0725 c 1.1648679,-0.0863 2.2409336,-0.43031 3.2197786,-1.02925 0.80266,-0.49114 1.518576,-1.16761 2.056098,-1.94279 0.699733,-1.00912 1.098431,-2.14665 1.191282,-3.39889 0.01258,-0.16971 0.01263,-0.69761 8.2e-5,-0.86556 -0.06301,-0.84305 -0.253506,-1.598 -0.590929,-2.34195 -0.72771,-1.60445 -2.077195,-2.88193 -3.7423358,-3.54267 -0.6921814,-0.27466 -1.3917181,-0.43283 -2.1532639,-0.48687 -0.2110999,-0.0149 -0.691169,-0.017 -0.8877173,-0.004 -0.9888034,0.0664 -1.8722493,0.30091 -2.7255116,0.7235 -1.9577294,0.96959 -3.32703481,2.76854 -3.71577361,4.88165 -0.0407666,0.22161 -0.0724425,0.46772 -0.0929919,0.72253 -0.0172841,0.21431 -0.0172778,0.74451 1.4e-5,0.96093 0.0271862,0.34027 0.071101,0.64197 0.13769768,0.94597 0.37632363,1.71777 1.41027703,3.22276 2.89369773,4.21197 0.3970474,0.26477 0.8471652,0.50017 1.3086163,0.68437 0.7333216,0.29274 1.5482681,0.46286 2.3703274,0.4948 0.1336585,0.005 0.5907033,-0.004 0.7309294,-0.0139 z m -4.191549,-1.62001 c -0.00522,-0.008 -0.0072,-0.16261 -0.00846,-0.66125 l -0.00108,-0.43256 -0.3853793,-0.38577 -0.3853793,-0.38578 0.0049,-0.12059 c 0.00267,-0.0663 7.637e-4,-0.73738 -0.00426,-1.49123 -0.00845,-1.26919 -0.00823,-1.37154 0.00293,-1.38271 0.010806,-0.0108 0.049848,-0.0123 0.3759705,-0.0142 l 0.3639122,-0.002 -0.00477,-1.06153 c -0.00261,-0.58384 -0.00636,-1.149 -0.0083,-1.25591 -0.00197,-0.10691 -0.00566,-0.59544 -0.00817,-1.08563 -0.00255,-0.49018 -0.00689,-1.21307 -0.00967,-1.60643 -0.00395,-0.56017 -0.00312,-0.71851 0.00401,-0.73053 0.00809,-0.0138 0.018251,-0.0158 0.098803,-0.0202 0.049377,-0.003 1.3602351,-0.005 2.9130145,-0.005 h 2.8232318 l 0.01204,0.0184 c 0.00662,0.0101 0.2039596,0.20402 0.4385261,0.43092 0.2345651,0.2269 0.5354541,0.51819 0.6686411,0.6473 0.133187,0.12912 0.392349,0.37982 0.575916,0.55711 0.183567,0.1773 0.384104,0.37132 0.445639,0.43116 l 0.111882,0.10881 v 0.0933 c 0,0.0514 0.0033,0.56535 0.0072,1.14227 0.0039,0.57692 0.01209,1.86262 0.01804,2.8571 0.0059,0.99449 0.01258,2.00786 0.01473,2.25194 0.0022,0.24408 0.006,0.81615 0.0087,1.27125 0.0046,0.80796 0.0045,0.82755 -0.0091,0.83093 -0.02491,0.006 -8.0596616,0.007 -8.0634945,6.4e-4 z m 8.0066816,-0.8577 c -0.0052,-0.83909 -0.01118,-1.7955 -0.03377,-5.3617 -0.0075,-1.18488 -0.01604,-2.15821 -0.01897,-2.16295 -0.004,-0.006 -0.05556,-0.008 -0.204277,-0.004 -0.109421,0.003 -0.570357,0.006 -1.024304,0.008 -0.4539446,0.002 -0.8619517,0.006 -0.9066804,0.008 l -0.081324,0.004 -0.0049,-0.49699 c -0.00267,-0.27335 -0.0049,-0.63426 -0.0049,-0.80204 -5.1e-6,-0.16776 -0.00216,-0.44124 -0.00484,-0.60771 l -0.00484,-0.30267 -2.8603425,3.4e-4 c -2.5983823,1.7e-4 -2.860749,0.001 -2.8647843,0.0118 -0.00242,0.006 -6.364e-4,0.62273 0.00401,1.36969 0.00465,0.74696 0.010106,1.66344 0.012129,2.03663 0.00204,0.37318 0.00528,0.80229 0.0073,0.95359 0.00197,0.15128 0.00414,0.49623 0.00471,0.76653 6.059e-4,0.27031 0.00261,0.50715 0.00439,0.52631 l 0.00331,0.0349 h 3.5678187 3.5678165 l 0.019,0.0226 0.019,0.0226 3.37e-4,0.46706 c 1.69e-4,0.25689 0.0017,0.48687 0.0032,0.51107 0.0024,0.0378 0.01517,1.82946 0.01372,1.92775 -3.37e-4,0.0194 -0.0037,0.0384 -0.0076,0.0424 -0.0046,0.004 -1.2836276,0.007 -3.5897606,0.007 l -3.5826432,-3.3e-4 0.00484,0.32834 c 0.00267,0.18058 0.00554,0.53464 0.00638,0.7868 8.273e-4,0.25215 0.00267,0.51374 0.00414,0.58132 l 0.00261,0.12286 h 3.9770693 3.9770695 l -0.005,-0.80138 z M 3.5862888,293.5639 c -0.00261,-0.0757 -0.00484,-0.22913 -0.00484,-0.34109 l -2.04e-5,-0.20356 H 3.2384795 2.8955278 l 0.3410878,0.3411 c 0.1875989,0.18759 0.3440998,0.34109 0.3477806,0.34109 0.00395,0 0.00471,-0.0561 0.00191,-0.13754 z m 7.1637262,-1.36987 c -0.0015,-0.41958 -0.0048,-1.06655 -0.0073,-1.43772 l -0.0045,-0.67485 -3.935326,-0.002 -3.9353258,-0.002 0.00477,0.5593 c 0.00261,0.30761 0.00653,0.92899 0.00867,1.38085 0.00216,0.45186 0.00573,0.84874 0.00801,0.88197 l 0.00414,0.0604 3.9298816,-0.002 3.9298822,-0.002 z m 0.5222,-5.74455 c 0.140377,-0.003 0.254274,-0.007 0.253109,-0.0106 -0.0021,-0.006 -0.09548,-0.0965 -0.981716,-0.95339 -0.235957,-0.22815 -0.5907802,-0.57134 -0.7884989,-0.76265 l -0.3594894,-0.34784 -0.00235,0.18315 c -0.00134,0.10075 -7.07e-5,0.57064 0.00274,1.04423 l 0.00509,0.86107 0.8079453,-0.004 c 0.44437,-0.003 0.922798,-0.007 1.063173,-0.009 z"
       id="path4546"
       inkscape:connector-curvature="0"
       sodipodi:nodetypes="sssssssssssccsccsccscsscccsssssssssccccscccsscscscssccscccscccssscsccccscssscssccscssscccccccccccscsssccccccccccssccsscccssccccsscccccccss" />
    <text xml:space="preserve" style="font-style:normal;font-weight:normal;font-size:2.40819693px;line-height:2.25;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;fill:#cf1f2f;fill-opacity:1;stroke:none;stroke-width:0.26458332" x="3.9452205" y="292.29498" id="text4566" transform="scale(1.0000816,0.99991843)"><tspan
         sodipodi:role="line"
         id="tspan4564"
         x="3.9452205"
         y="292.52498"
         style="stroke-width:0.26458332">PDF</tspan></text>
  </g>
</svg><!--<img class="download-icon" src="/wp-content/themes/amfence/images/pdf-turq.png" alt="Download pdf file" />--></a>
					<?php
						}
					?>
				</div>

			<?php 
				}
			endwhile; ?>
		</div>
		<?php if($vars['num_items'] > 0): ?>
			<div class="row">
				<div class="col">
					<a class="view-all" href="/cad-drawings/">View More CAD Drawings and Specifications</a>
				</div>
			</div>
		<?php endif; ?>
	</div>

<?php endif; wp_reset_postdata(); ?>

</section>